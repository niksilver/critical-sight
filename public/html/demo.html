<html>
<head>
<meta charset="utf-8">
<title>Critical Sight Gantt chart</title>

<!-- Get the graphics library from local lib -->
<script	src="/public/lib/easeljs-0.8.0.min.js"></script>

<!-- Get the jQuery from CDN. Required for ready() function. -->
<script src="http://code.jquery.com/jquery-2.1.3.js"></script>

</head>
<body>

	<canvas id="c" style="border: 1px solid black;"></canvas>
	
	<form action="#" method="POST">
	<textarea id="plantext" name="text" rows="10" cols="60"></textarea>
	<span id="submit">Go!</span>
	</form>

</body>

<!-- Our own code -->
<script src="/public/javascripts/CriticalSight.js"></script>
<script src="/public/javascripts/Sizer.js"></script>
<script src="/public/javascripts/DependencyMaker.js"></script>
<script src="/public/javascripts/PeriodMaker.js"></script>
<script src="/public/javascripts/Plan.js"></script>
<script src="/public/javascripts/DemoChart.js"></script>

<script>
	var CS = CriticalSight;
	
	var defaultPlan =
	    't0: "Start"\n' +
	    't1: "Write a long list" 2.0\n' +
	    't2: "Do what\'s on the list" 5.0\n' +
	    'tEnd: "End"\n' +
	    't4: "Extra work" 2.0\n' +
	    't0 -> t1 -> tEnd\n' +
	    't0 -> t2 -> tEnd\n' +
	    't0 -> t4 -> t1\n' +
	    't4 -> tEnd\n';
	
	$("#plantext").val(defaultPlan);
	
	$(function() {

		var htmlCanvas = document.getElementById('c');
		htmlCanvas.width = 1000;
		htmlCanvas.height = 500;

		var stage = new createjs.Stage(htmlCanvas);

		var uri = '/readPlan';
		$.post(
		    uri,
		    "text=" + encodeURI(defaultPlan),
		    function(spec) {
			    CS.DemoChart.run(stage, spec);
            });

		$("#submit").click(function() {
		    var text = $("#plantext").val();
		    stage.removeAllChildren();
		    stage.update();
			$.post('/readPlan',
				    "text=" + encodeURI(text),
				    function(spec) {
					    CS.DemoChart.run(stage, spec);
		            });
		});
	});
</script>
</html>
